<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meemon - ‡∏ö‡∏±‡∏ï‡∏£‡∏°‡∏π‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏î‡∏ß‡∏á</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        :root {
            --gold: #d4af37;
            --gold-glow: 0 0 15px rgba(212, 175, 55, 0.3);
            --dark-bg: #05020a;
        }

        body {
            font-family: 'Prompt', sans-serif;
            background-color: var(--dark-bg);
            background-image: radial-gradient(circle at 50% 0%, #2e1065 0%, #000000 80%);
            color: #e2e8f0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        h1, h2, h3, .mystic-font {
            font-family: 'Cinzel', serif;
        }

        /* Ambient Animation Background */
        .fog-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0;
            animation: twinkle var(--duration) ease-in-out infinite;
            animation-delay: var(--delay);
        }

        @keyframes twinkle {
            0% { opacity: 0; transform: scale(0.5); }
            50% { opacity: var(--opacity); transform: scale(1.2); }
            100% { opacity: 0; transform: scale(0.5); }
        }

        /* Card Flip Animation (Fortune Page) */
        .perspective-1000 {
            perspective: 1000px;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }
        
        .card-inner.flipped {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
        }
        
        /* Fortune Card Styles */
        .card-front {
            background: #1a1a1a;
            border: 2px solid var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: 
                radial-gradient(circle at center, transparent 0%, #1a1a1a 100%),
                repeating-linear-gradient(45deg, rgba(212, 175, 55, 0.1) 0px, rgba(212, 175, 55, 0.1) 2px, transparent 2px, transparent 10px);
        }

        .card-symbol {
            width: 80%;
            height: 80%;
            border: 1px solid rgba(212, 175, 55, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .card-symbol::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 70%;
            border: 1px solid rgba(212, 175, 55, 0.3);
            transform: rotate(45deg);
        }
        
        .card-back {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            color: #1e1b4b;
            transform: rotateY(180deg);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            border: 4px double var(--gold);
        }

        /* Mystic Panel */
        .mystic-panel {
            background: rgba(10, 5, 20, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            border-radius: 1rem;
        }

        /* Button Styles */
        .btn-mystic {
            background: linear-gradient(180deg, #2d1b4e 0%, #1a0b2e 100%);
            border: 1px solid rgba(212, 175, 55, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-mystic:hover {
            border-color: var(--gold);
            box-shadow: var(--gold-glow);
            transform: translateY(-2px);
        }
        
        .btn-mystic::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            opacity: 0;
            transform: scale(0.5);
            transition: opacity 0.5s, transform 0.5s;
        }
        
        .btn-mystic:active::after {
            opacity: 1;
            transform: scale(1);
            transition: 0s;
        }

        .text-gold-gradient {
            background: linear-gradient(to bottom, #ffd700, #b8860b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Day Buttons Grid */
        .day-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .day-card-btn {
            position: relative;
            height: 4rem; 
            border-radius: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0 1rem;
            gap: 0.75rem;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .day-card-btn:hover {
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .day-card-btn .icon {
            font-size: 1.5rem;
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.4));
        }

        .day-card-btn .label {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Unique Gradients Per Day */
        .day-sun { background: linear-gradient(135deg, rgba(153, 27, 27, 0.4) 0%, rgba(69, 10, 10, 0.6) 100%); color: #fca5a5; border-color: rgba(239, 68, 68, 0.3); }
        .day-mon { background: linear-gradient(135deg, rgba(161, 98, 7, 0.4) 0%, rgba(66, 32, 6, 0.6) 100%); color: #fde047; border-color: rgba(234, 179, 8, 0.3); }
        .day-tue { background: linear-gradient(135deg, rgba(157, 23, 77, 0.4) 0%, rgba(80, 7, 36, 0.6) 100%); color: #f9a8d4; border-color: rgba(236, 72, 153, 0.3); }
        .day-wed-d { background: linear-gradient(135deg, rgba(6, 78, 59, 0.4) 0%, rgba(2, 44, 34, 0.6) 100%); color: #6ee7b7; border-color: rgba(16, 185, 129, 0.3); }
        .day-wed-n { background: linear-gradient(135deg, rgba(51, 65, 85, 0.4) 0%, rgba(15, 23, 42, 0.6) 100%); color: #cbd5e1; border-color: rgba(148, 163, 184, 0.3); }
        .day-thu { background: linear-gradient(135deg, rgba(124, 45, 18, 0.4) 0%, rgba(67, 20, 7, 0.6) 100%); color: #fdba74; border-color: rgba(249, 115, 22, 0.3); }
        .day-fri { background: linear-gradient(135deg, rgba(30, 58, 138, 0.4) 0%, rgba(23, 37, 84, 0.6) 100%); color: #93c5fd; border-color: rgba(59, 130, 246, 0.3); }
        .day-sat { background: linear-gradient(135deg, rgba(88, 28, 135, 0.4) 0%, rgba(46, 16, 101, 0.6) 100%); color: #d8b4fe; border-color: rgba(168, 85, 247, 0.3); }
        .day-any { background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%); color: #fff; border-color: rgba(255, 255, 255, 0.2); grid-column: span 2; justify-content: center; }

        /* --- STACK CARD STYLES (SOLID & DETAILED) --- */
        .stack-container {
            position: relative;
            width: 260px; 
            height: 380px; 
            margin: 0 auto;
            perspective: 1200px;
        }

        .stack-card {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 1rem;
            /* Base shadow */
            box-shadow: 0 15px 35px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            overflow: hidden;
            cursor: pointer;
            border: 2px solid; 
        }

        /* Specific Card Styles - SOLID BACKGROUNDS WITH PATTERNS */
        /* 1. Wealth (Green/Gold) */
        .stack-card.wealth {
            border-color: #ffd700;
            background: 
                repeating-linear-gradient(45deg, rgba(255, 215, 0, 0.15) 0px, rgba(255, 215, 0, 0.15) 2px, transparent 2px, transparent 15px),
                radial-gradient(circle at 50% 30%, #15803d 0%, #14532d 60%, #022c22 100%);
        }

        /* 2. Love (Pink/Red) */
        .stack-card.love {
            border-color: #f472b6;
            background: 
                repeating-linear-gradient(-45deg, rgba(244, 114, 182, 0.15) 0px, rgba(244, 114, 182, 0.15) 2px, transparent 2px, transparent 15px),
                radial-gradient(circle at 50% 30%, #db2777 0%, #9d174d 60%, #500724 100%);
        }

        /* 3. Work (Blue/Indigo) */
        .stack-card.work {
            border-color: #60a5fa;
            background: 
                repeating-linear-gradient(0deg, rgba(96, 165, 250, 0.1) 0px, rgba(96, 165, 250, 0.1) 1px, transparent 1px, transparent 20px),
                repeating-linear-gradient(90deg, rgba(96, 165, 250, 0.1) 0px, rgba(96, 165, 250, 0.1) 1px, transparent 1px, transparent 20px),
                radial-gradient(circle at 50% 30%, #2563eb 0%, #1e40af 60%, #172554 100%);
        }

        /* 4. Health (Teal/Emerald) */
        .stack-card.health {
            border-color: #34d399;
            background: 
                radial-gradient(rgba(52, 211, 153, 0.2) 2px, transparent 2px),
                radial-gradient(circle at 50% 30%, #10b981 0%, #047857 60%, #064e3b 100%);
            background-size: 20px 20px, 100% 100%;
        }
        
        /* New Styles for Anyday Aspects */
        .stack-card.trade { border-color: #fb923c; background: radial-gradient(circle at 50% 30%, #ea580c 0%, #c2410c 60%, #7c2d12 100%); }
        .stack-card.luck { border-color: #facc15; background: radial-gradient(circle at 50% 30%, #ca8a04 0%, #a16207 60%, #713f12 100%); }
        .stack-card.mercy { border-color: #e2e8f0; background: radial-gradient(circle at 50% 30%, #94a3b8 0%, #64748b 60%, #475569 100%); }
        .stack-card.education { border-color: #818cf8; background: radial-gradient(circle at 50% 30%, #4f46e5 0%, #4338ca 60%, #312e81 100%); }
        .stack-card.success { border-color: #c084fc; background: radial-gradient(circle at 50% 30%, #9333ea 0%, #7e22ce 60%, #581c87 100%); }

        /* Back Face */
        .stack-card-back { transform: rotateY(180deg); background: #000; border-color: var(--gold); }
        .stack-card-back img { width: 100%; height: 100%; object-fit: cover; }

        /* Front Face */
        .stack-card-front, .stack-card-back {
            position: absolute; width: 100%; height: 100%; border-radius: 1rem; backface-visibility: hidden; -webkit-backface-visibility: hidden; border: 2px solid; box-shadow: 0 15px 35px rgba(0,0,0,0.8); overflow: hidden;
        }
        .stack-card-front { background: transparent; display: flex; flex-direction: column; align-items: center; justify-content: center; }

        /* Stack States */
        .stack-card.active { z-index: 10; transform: translateY(0) scale(1); opacity: 1; box-shadow: 0 0 35px rgba(255, 255, 255, 0.25); }
        .stack-card.next { z-index: 5; transform: translateY(30px) scale(0.92); opacity: 1; filter: brightness(0.5); }
        .stack-card.prev { z-index: 1; transform: translateY(50px) scale(0.85); opacity: 1; filter: brightness(0.3); pointer-events: auto; cursor: pointer; }
        .stack-card.hidden-card { z-index: 0; transform: translateY(50px) scale(0.85); opacity: 0; pointer-events: none; }

        .stack-card-inner-border { position: absolute; inset: 8px; border: 2px solid rgba(255, 255, 255, 0.4); border-radius: 12px; pointer-events: none; }

        /* Consecration Animation */
        @keyframes floatAndFlip {
            0% { transform: translateY(0) scale(1) rotateY(0); }
            40% { transform: translateY(-60px) scale(1.1) rotateY(20deg); box-shadow: 0 0 50px var(--gold); }
            100% { transform: translateY(-30px) scale(1.05) rotateY(180deg); }
        }
        .stack-card.consecrating { animation: floatAndFlip 1.5s forwards cubic-bezier(0.45, 0, 0.55, 1); z-index: 50 !important; }

        /* Flash Overlay */
        #magic-overlay { pointer-events: none; opacity: 0; transition: opacity 0.5s; background: radial-gradient(circle, rgba(255, 215, 0, 0.6) 0%, transparent 70%); }
        #magic-overlay.active { opacity: 1; }
        
        /* Flash Effect on Active Card */
        .stack-card::after { content: ''; position: absolute; top: 50%; left: 50%; width: 300%; height: 300%; background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, transparent 70%); transform: translate(-50%, -50%) scale(0); opacity: 0; transition: transform 0.5s, opacity 0.5s; pointer-events: none; z-index: 2; mix-blend-mode: overlay; }
        .stack-card.active.flash-trigger::after { transform: translate(-50%, -50%) scale(1); opacity: 1; transition: 0s; }

        /* Toast */
        .toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 8px; padding: 16px; position: fixed; z-index: 100; left: 50%; bottom: 30px; transform: translateX(-50%); border: 1px solid var(--gold); box-shadow: 0 5px 15px rgba(0,0,0,0.5); opacity: 0; transition: opacity 0.3s; }
        .toast.show { visibility: visible; opacity: 1; }

        /* Nav */
        .nav-btn { @apply bg-black/40 border border-white/20 text-white/80 p-3 rounded-full transition-all active:scale-90 hover:bg-white/10 hover:text-yellow-400 hover:border-yellow-500/50; }
    </style>
</head>
<body class="flex flex-col items-center justify-between p-4">

    <!-- Ambient Background -->
    <div class="fog-container" id="stars-container"></div>

    <!-- Magical Flash Overlay -->
    <div id="magic-overlay" class="fixed inset-0 z-40 flex items-center justify-center">
        <div class="w-full h-full bg-white/10 mix-blend-overlay animate-pulse"></div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="flex flex-col items-center gap-2">
            <i data-lucide="check-circle" class="text-green-400 w-8 h-8"></i>
            <span class="font-bold text-gold-gradient text-lg">‡∏õ‡∏•‡∏∏‡∏Å‡πÄ‡∏™‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>
            <span class="text-xs text-gray-300">‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</span>
        </div>
    </div>

    <!-- Header -->
    <header class="w-full text-center py-6 z-10">
        <div class="inline-flex items-center gap-3 mb-2">
            <img src="https://raw.githubusercontent.com/taithai-tai/meemon/refs/heads/main/Picture/logo.png" alt="Logo" class="w-16 h-16 object-contain drop-shadow-md">
            <h1 class="text-5xl font-bold tracking-widest text-gold-gradient drop-shadow-md mt-2">MEEMON</h1>
            <img src="https://raw.githubusercontent.com/taithai-tai/meemon/refs/heads/main/Picture/logo.png" alt="Logo" class="w-16 h-16 object-contain drop-shadow-md">
        </div>
        <div class="flex items-center justify-center gap-2 opacity-60">
            <div class="h-[1px] w-8 bg-gradient-to-r from-transparent to-yellow-500"></div>
            <p class="text-[10px] tracking-[0.2em] text-yellow-100 uppercase font-light">Destiny & Faith</p>
            <div class="h-[1px] w-8 bg-gradient-to-l from-transparent to-yellow-500"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="app-container" class="w-full max-w-md flex-grow flex flex-col items-center justify-center relative z-10">
        
        <!-- HOME PAGE -->
        <div id="home-view" class="w-full flex flex-col gap-6 animate-fade-in">
            <!-- (Content same as before) -->
            <div class="mystic-panel p-8 text-center relative overflow-hidden group">
                <div class="absolute inset-0 bg-gradient-to-b from-purple-500/5 to-transparent pointer-events-none"></div>
                <div class="relative z-10">
                    <div class="w-56 h-56 mx-auto mb-6 drop-shadow-[0_0_25px_rgba(212,175,55,0.4)]">
                        <img src="https://raw.githubusercontent.com/taithai-tai/meemon/refs/heads/main/Picture/logo.png" class="w-full h-full object-contain">
                    </div>
                    <h2 class="text-2xl font-bold text-yellow-100 mb-2">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà MEEMON</h2>
                    <p class="text-sm text-gray-400 font-light leading-relaxed">‡∏î‡∏ß‡∏á‡∏ä‡∏∞‡∏ï‡∏≤‡∏ü‡πâ‡∏≤‡∏•‡∏¥‡∏Ç‡∏¥‡∏ï ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏¥‡∏ï‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
                </div>
            </div>
            <div class="space-y-4">
                <button onclick="goToFortune()" class="btn-mystic w-full p-5 rounded-xl flex items-center justify-between group">
                    <div class="flex items-center gap-4">
                        <div class="bg-black/40 border border-purple-500/30 p-3 rounded-lg"><i data-lucide="eye" class="text-purple-300 w-6 h-6"></i></div>
                        <div class="text-left"><h3 class="font-bold text-lg text-yellow-50">‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏î‡∏ß‡∏á‡∏ä‡∏∞‡∏ï‡∏≤</h3><p class="text-[10px] text-purple-200/60">Pick a Card</p></div>
                    </div>
                    <i data-lucide="chevron-right" class="text-purple-500/50"></i>
                </button>
                <button onclick="goToWallpaper()" class="btn-mystic w-full p-5 rounded-xl flex items-center justify-between group">
                    <div class="flex items-center gap-4">
                        <div class="bg-black/40 border border-teal-500/30 p-3 rounded-lg"><i data-lucide="smartphone" class="text-teal-300 w-6 h-6"></i></div>
                        <div class="text-left"><h3 class="font-bold text-lg text-yellow-50">‡∏¢‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå</h3><p class="text-[10px] text-teal-200/60">Sacred Wallpaper</p></div>
                    </div>
                    <i data-lucide="chevron-right" class="text-teal-500/50"></i>
                </button>
            </div>
        </div>

        <!-- FORTUNE PAGE -->
        <div id="fortune-view" class="w-full hidden flex-col items-center">
            <button onclick="goHome()" class="self-start mb-6 flex items-center text-xs text-yellow-500/70 hover:text-yellow-400 uppercase tracking-widest"><i data-lucide="arrow-left" class="w-4 h-4 mr-2"></i> Back</button>
            <div class="perspective-1000 w-64 h-96 cursor-pointer group mb-4" onclick="flipCard()">
                <div id="the-card" class="card-inner">
                    <div class="card-front">
                        <div class="card-symbol">
                            <div class="text-center transform translate-y-2">
                                <img src="https://raw.githubusercontent.com/taithai-tai/meemon/refs/heads/main/Picture/logo.png" class="w-32 h-32 mx-auto mb-4 object-contain opacity-90 drop-shadow-md">
                                <span class="mystic-font text-yellow-600/80 font-bold tracking-[0.3em] text-2xl block">FATE</span>
                                <div class="mt-4 w-20 h-[2px] bg-yellow-600/30 mx-auto"></div>
                            </div>
                        </div>
                    </div>
                    <div class="card-back">
                        <div class="w-full text-center border-b border-yellow-200 pb-2">
                            <div class="text-[10px] text-gray-500 uppercase tracking-[0.2em] mb-1">The Oracle Says</div>
                            <h3 id="card-title" class="text-xl font-bold text-slate-800 mystic-font">Name</h3>
                        </div>
                        <div id="card-icon" class="text-5xl my-2 opacity-90">üîÆ</div>
                        <div class="text-center px-1 flex-grow flex items-center"><p id="card-desc" class="text-sm text-slate-600 leading-7 font-light">Meaning...</p></div>
                        <div class="w-full border-t border-yellow-200 pt-2 flex justify-between items-center px-4"><span class="text-[10px] text-gray-400">Lucky No.</span><span id="card-lucky" class="text-lg font-bold text-yellow-700">88</span></div>
                    </div>
                </div>
            </div>
            <p class="text-xs text-purple-300/50 mb-6 italic" id="tap-hint">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏û‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢</p>
            <button id="reset-card-btn" onclick="resetCard()" class="btn-mystic px-8 py-3 rounded-full text-sm font-bold text-yellow-100 border border-yellow-500/30 opacity-0 pointer-events-none">‡∏™‡∏∏‡πà‡∏°‡∏ä‡∏∞‡∏ï‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
        </div>

        <!-- WALLPAPER PAGE: Step 1 Select Day -->
        <div id="wallpaper-view" class="w-full hidden flex-col items-center">
            <button onclick="goHome()" class="self-start mb-6 flex items-center text-xs text-yellow-500/70 hover:text-yellow-400 uppercase tracking-widest"><i data-lucide="arrow-left" class="w-4 h-4 mr-2"></i> Back</button>
            <div id="day-selection-panel" class="mystic-panel w-full p-6 mb-6">
                <label class="block text-center text-sm text-yellow-100/90 uppercase tracking-wider mb-4 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô</label>
                <div class="day-grid mb-2">
                    <button onclick="selectDay('sunday')" class="day-card-btn day-sun">
                        <span class="icon">‚òÄÔ∏è</span> <span class="label">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</span>
                    </button>
                    <button onclick="selectDay('monday')" class="day-card-btn day-mon">
                        <span class="icon">üåï</span> <span class="label">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</span>
                    </button>
                    <button onclick="selectDay('tuesday')" class="day-card-btn day-tue">
                        <span class="icon">üå∏</span> <span class="label">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</span>
                    </button>
                    <button onclick="selectDay('wednesday_day')" class="day-card-btn day-wed-d">
                        <span class="icon">üå≥</span> <span class="label">‡∏û‡∏∏‡∏ò‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô</span>
                    </button>
                    <button onclick="selectDay('wednesday_night')" class="day-card-btn day-wed-n">
                        <span class="icon">üåë</span> <span class="label">‡∏û‡∏∏‡∏ò‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô</span>
                    </button>
                    <button onclick="selectDay('thursday')" class="day-card-btn day-thu">
                        <span class="icon">üßò</span> <span class="label">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</span>
                    </button>
                    <button onclick="selectDay('friday')" class="day-card-btn day-fri">
                        <span class="icon">üíé</span> <span class="label">‡∏®‡∏∏‡∏Å‡∏£‡πå</span>
                    </button>
                    <button onclick="selectDay('saturday')" class="day-card-btn day-sat">
                        <span class="icon">üî•</span> <span class="label">‡πÄ‡∏™‡∏≤‡∏£‡πå</span>
                    </button>
                    <button onclick="selectDay('anyday')" class="day-card-btn day-any">
                        <span class="icon">‚ú®</span> <span class="label">‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</span>
                    </button>
                </div>
            </div>

            <!-- ASPECT SELECTION: Step 2 Stack Carousel -->
            <div id="aspect-selection-panel" class="hidden w-full flex-col items-center">
                <button onclick="resetToDaySelection()" class="self-start mb-6 flex items-center text-xs text-yellow-500/70 hover:text-yellow-400 uppercase tracking-widest"><i data-lucide="arrow-left" class="w-3 h-3 mr-1"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
                
                <div class="flex items-center justify-between w-full max-w-xs mb-2">
                    <button onclick="prevCard()" class="nav-btn"><i data-lucide="chevron-left"></i></button>
                    <h3 class="text-gold-gradient font-bold text-lg tracking-widest">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏£‡∏ñ‡∏ô‡∏≤</h3>
                    <button onclick="nextCard()" class="nav-btn"><i data-lucide="chevron-right"></i></button>
                </div>

                <!-- STACK CONTAINER -->
                <div class="stack-container my-6">
                    <div id="card-stack"></div>
                </div>

                <div class="text-xs text-white/40 mb-4 animate-pulse">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</div>

                <!-- Generate Button -->
                <button onclick="generateFromStack()" class="mt-2 w-full max-w-xs bg-gradient-to-r from-yellow-700 to-yellow-600 hover:from-yellow-600 hover:to-yellow-500 text-white font-bold py-4 rounded-full shadow-lg shadow-yellow-900/40 transition-all border border-yellow-400/30 active:scale-95 flex items-center justify-center gap-2 group">
                    <i data-lucide="sparkles" class="w-5 h-5 group-hover:rotate-12 transition-transform"></i>
                    <span>‡∏õ‡∏•‡∏∏‡∏Å‡πÄ‡∏™‡∏Å‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå</span>
                </button>
            </div>

            <!-- RESULT DISPLAY -->
            <div id="wallpaper-result" class="hidden flex-col items-center w-full animate-fade-in pb-10">
                <button onclick="resetToAspectSelection()" class="self-start mb-4 flex items-center text-xs text-yellow-500/70 hover:text-yellow-400 uppercase tracking-widest"><i data-lucide="arrow-left" class="w-3 h-3 mr-1"></i> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>
                <div class="relative w-2/3 group mb-4">
                    <div class="absolute -inset-1 bg-gradient-to-r from-yellow-600 to-purple-600 rounded-2xl blur opacity-25 group-hover:opacity-75 transition duration-1000 group-hover:duration-200"></div>
                    <!-- The generated image will populate here -->
                    <img id="generated-image" class="relative w-full rounded-xl shadow-2xl border border-white/10 cursor-pointer" alt="Wallpaper">
                </div>
                <div class="text-center space-y-1">
                    <p class="text-xs text-yellow-200/80">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</p>
                    <p class="text-[10px] text-gray-500 uppercase tracking-widest">Sacred Image Generated</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-8 text-center pb-4"><p class="text-[10px] text-white/20 uppercase tracking-[0.3em]">MEEMON Card</p></footer>

    <script>
        lucide.createIcons();
        const starsContainer = document.getElementById('stars-container');
        for(let i=0; i<30; i++) {
            const star=document.createElement('div'); star.classList.add('star');
            star.style.left=`${Math.random()*100}%`; star.style.top=`${Math.random()*100}%`;
            star.style.width=`${Math.random()*3+1}px`; star.style.height=star.style.width;
            star.style.setProperty('--duration', `${Math.random()*3+2}s`);
            star.style.setProperty('--delay', `${Math.random()*5}s`);
            star.style.setProperty('--opacity', Math.random()*0.5+0.3);
            starsContainer.appendChild(star);
        }

        const cards = [
            { name: "The Sun", icon: "‚òÄÔ∏è", meaning: "‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏à‡∏±‡∏Å‡∏™‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏≠‡∏±‡∏ô‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏à‡∏±‡∏Å‡∏°‡∏•‡∏≤‡∏¢‡∏™‡∏¥‡πâ‡∏ô", lucky: "1, 9" },
            { name: "The Lovers", icon: "‚ù§Ô∏è‚Äçüî•", meaning: "‡∏ó‡∏≤‡∏á‡πÅ‡∏¢‡∏Å‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤ ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏à‡∏±‡∏Å‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÄ‡∏à‡πâ‡∏≤ ‡∏à‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏°‡∏¥‡πÉ‡∏ä‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ß", lucky: "2, 6" },
            { name: "Wheel of Fortune", icon: "‚ò∏Ô∏è", meaning: "‡∏Å‡∏á‡∏•‡πâ‡∏≠‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏°‡∏∏‡∏ô ‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏ß‡πâ‡∏à‡∏±‡∏Å‡∏¢‡πâ‡∏≠‡∏ô‡∏Ñ‡∏∑‡∏ô ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡∏°‡πà‡∏à‡∏±‡∏Å‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏î‡∏±‡πà‡∏á‡∏õ‡∏≤‡∏è‡∏¥‡∏´‡∏≤‡∏£‡∏¥‡∏¢‡πå", lucky: "10" },
            { name: "The Magician", icon: "üîÆ", meaning: "‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡πÄ‡∏à‡πâ‡∏≤ ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏µ‡πà‡∏à‡∏±‡∏Å‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏∏‡∏ô ‡∏à‡∏á‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ù‡∏±‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á", lucky: "1, 5" },
            { name: "The Star", icon: "‚ú®", meaning: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á‡∏î‡∏±‡πà‡∏á‡∏î‡∏≤‡∏£‡∏≤‡∏ö‡∏ô‡∏ü‡∏≤‡∏Å‡∏ü‡πâ‡∏≤ ‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡∏¢‡∏ß‡∏¢‡∏≤‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏á‡∏ö‡∏™‡∏∏‡∏Ç‡∏à‡∏±‡∏Å‡∏ö‡∏±‡∏á‡πÄ‡∏Å‡∏¥‡∏î", lucky: "17" },
            { name: "The Empress", icon: "üëë", meaning: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏û‡∏π‡∏ô‡∏™‡∏∏‡∏Ç ‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå‡∏≠‡∏±‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡πâ‡∏ô ‡∏•‡∏≤‡∏†‡∏¢‡∏®‡∏™‡∏£‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏ç‡∏à‡∏±‡∏Å‡∏´‡∏•‡∏±‡πà‡∏á‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤", lucky: "3" },
            { name: "Ace of Pentacles", icon: "üíé", meaning: "‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏Ç‡∏∏‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡∏Å ‡∏•‡∏≤‡∏†‡∏•‡∏≠‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏±‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡∏à‡∏á‡πÑ‡∏Ç‡∏ß‡πà‡∏Ñ‡∏ß‡πâ‡∏≤‡πÑ‡∏ß‡πâ", lucky: "8" },
            { name: "The Moon", icon: "üåô", meaning: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏£‡πâ‡∏ô ‡∏à‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏ç‡∏≤‡∏ì ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏†‡∏≤‡∏û‡∏•‡∏ß‡∏á‡∏ï‡∏≤ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏ä‡πâ‡∏≤", lucky: "18" },
            { name: "Death", icon: "üíÄ", meaning: "‡∏à‡∏∏‡∏î‡∏à‡∏ö‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏´‡∏ç‡πà‡∏à‡∏±‡∏Å‡∏ô‡∏≥‡∏û‡∏≤‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏´‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°", lucky: "13" }
        ];

        // Image Database
        const wallpaperDB = {
            sunday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B2%E0%B8%97%E0%B8%B4%E0%B8%95%E0%B8%A2%E0%B9%8C/S__2908233_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B2%E0%B8%97%E0%B8%B4%E0%B8%95%E0%B8%A2%E0%B9%8C/S__2908234_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B2%E0%B8%97%E0%B8%B4%E0%B8%95%E0%B8%A2%E0%B9%8C/S__2908235_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B2%E0%B8%97%E0%B8%B4%E0%B8%95%E0%B8%A2%E0%B9%8C/S__2908236_0.jpg?raw=true"
            },
            monday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%88%E0%B8%B1%E0%B8%99%E0%B8%97%E0%B8%A3%E0%B9%8C/S__2908191_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%88%E0%B8%B1%E0%B8%99%E0%B8%97%E0%B8%A3%E0%B9%8C/S__2908192_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%88%E0%B8%B1%E0%B8%99%E0%B8%97%E0%B8%A3%E0%B9%8C/S__2908193_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%88%E0%B8%B1%E0%B8%99%E0%B8%97%E0%B8%A3%E0%B9%8C/S__2908194_0.jpg?raw=true"
            },
            tuesday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%B2%E0%B8%A3/S__2908197_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%B2%E0%B8%A3/S__2908198_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%B2%E0%B8%A3/S__2908199_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%AD%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%B2%E0%B8%A3/S__2908200_0.jpg?raw=true"
            },
            wednesday_day: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%A7%E0%B8%A7%E0%B8%B1%E0%B8%99/S__2908204_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%A7%E0%B8%A7%E0%B8%B1%E0%B8%99/S__2908203_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%A7%E0%B8%A7%E0%B8%B1%E0%B8%99/S__2908205_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%A7%E0%B8%A7%E0%B8%B1%E0%B8%99/S__2908206_0.jpg?raw=true"
            },
            wednesday_night: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%84%E0%B8%B7%E0%B8%99/S__2908209_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%84%E0%B8%B7%E0%B8%99/S__2908210_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%84%E0%B8%B7%E0%B8%99/S__2908211_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%B8%E0%B8%97%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%84%E0%B8%B7%E0%B8%99/S__2908212_0.jpg?raw=true"
            },
            thursday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%A4%E0%B8%AB%E0%B8%B1%E0%B8%AA%E0%B8%9A%E0%B8%94%E0%B8%B5/S__2908215_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%A4%E0%B8%AB%E0%B8%B1%E0%B8%AA%E0%B8%9A%E0%B8%94%E0%B8%B5/S__2908216_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%A4%E0%B8%AB%E0%B8%B1%E0%B8%AA%E0%B8%9A%E0%B8%94%E0%B8%B5/S__2908217_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%9E%E0%B8%A4%E0%B8%AB%E0%B8%B1%E0%B8%AA%E0%B8%9A%E0%B8%94%E0%B8%B5/S__2908218_0.jpg?raw=true"
            },
            friday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%A8%E0%B8%B8%E0%B8%81%E0%B8%A3%E0%B9%8C/S__2908221_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%A8%E0%B8%B8%E0%B8%81%E0%B8%A3%E0%B9%8C/S__2908222_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%A8%E0%B8%B8%E0%B8%81%E0%B8%A3%E0%B9%8C/S__2908223_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B8%A8%E0%B8%B8%E0%B8%81%E0%B8%A3%E0%B9%8C/S__2908224_0.jpg?raw=true"
            },
            saturday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%80%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B9%8C/S__2908227_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%80%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B9%8C/S__2908228_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%80%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B9%8C/S__2908229_0.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%80%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B9%8C/S__2908230_0.jpg?raw=true"
            },
            anyday: {
                wealth: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908240_0.jpg?raw=true",
                work: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908241_0.jpg?raw=true",
                love: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908251.jpg?raw=true",
                health: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908243_0.jpg?raw=true",
                power: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908244_0.jpg?raw=true",
                trade: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908245_0.jpg?raw=true",
                education: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908246_0.jpg?raw=true",
                mercy: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908248.jpg?raw=true",
                luck: "https://github.com/taithai-tai/meemon/blob/main/card/Picture/%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94/S__2908242_0.jpg?raw=true"
            }
        };

        function goHome() { hideAll(); document.getElementById('home-view').classList.remove('hidden'); document.getElementById('home-view').classList.add('flex'); if(document.getElementById('the-card').classList.contains('flipped')) setTimeout(resetCard, 300); }
        function goToFortune() { hideAll(); document.getElementById('fortune-view').classList.remove('hidden'); document.getElementById('fortune-view').classList.add('flex'); }
        function goToWallpaper() { hideAll(); document.getElementById('wallpaper-view').classList.remove('hidden'); document.getElementById('wallpaper-view').classList.add('flex'); resetWallpaperView(); }
        function hideAll() { ['home-view', 'fortune-view', 'wallpaper-view'].forEach(id => { document.getElementById(id).classList.add('hidden'); document.getElementById(id).classList.remove('flex'); }); }

        let isFlipped = false;
        function flipCard() {
            if(isFlipped) return;
            document.getElementById('tap-hint').style.opacity='0';
            const c=cards[Math.floor(Math.random()*cards.length)];
            document.getElementById('card-title').innerText=c.name;
            document.getElementById('card-icon').innerText=c.icon;
            document.getElementById('card-desc').innerText=c.meaning;
            document.getElementById('card-lucky').innerText=c.lucky;
            document.getElementById('the-card').classList.add('flipped'); isFlipped=true;
            document.getElementById('reset-card-btn').classList.remove('opacity-0','pointer-events-none');
        }
        function resetCard() { document.getElementById('the-card').classList.remove('flipped'); isFlipped=false; document.getElementById('tap-hint').style.opacity='1'; document.getElementById('reset-card-btn').classList.add('opacity-0','pointer-events-none'); }

        // --- STACK & ANIMATION LOGIC ---
        let selectedDay = '';
        let aspectCards = [];
        let activeCardIndex = 0;

        function selectDay(day) {
            selectedDay = day;
            document.getElementById('day-selection-panel').classList.add('hidden');
            document.getElementById('aspect-selection-panel').classList.remove('hidden');
            document.getElementById('aspect-selection-panel').classList.add('flex');

            // Populate aspect cards based on day
            if (day === 'anyday') {
                aspectCards = [
                    { id: 'wealth', label: '‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏á', icon: 'üí∞', sub: 'Wealth' },
                    { id: 'work', label: '‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô', icon: 'üíº', sub: 'Work' },
                    { id: 'love', label: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å', icon: 'üíò', sub: 'Love' },
                    { id: 'health', label: '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', icon: 'üåø', sub: 'Health' },
                    { id: 'power', label: '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à', icon: 'ü¶Å', sub: 'Power' },
                    { id: 'trade', label: '‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢', icon: '‚öñÔ∏è', sub: 'Trade' },
                    { id: 'education', label: '‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', icon: 'üéì', sub: 'Education' },
                    { id: 'mercy', label: '‡πÄ‡∏°‡∏ï‡∏ï‡∏≤', icon: 'ü§≤', sub: 'Mercy' },
                    { id: 'luck', label: '‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†', icon: 'üçÄ', sub: 'Luck' }
                ];
            } else {
                // Standard 4 for specific days
                aspectCards = [
                    { id: 'wealth', label: '‡∏°‡∏´‡∏≤‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏µ', icon: 'üí∞', sub: 'Wealth' },
                    { id: 'love', label: '‡πÄ‡∏™‡∏ô‡πà‡∏´‡∏≤', icon: 'üíò', sub: 'Love' },
                    { id: 'work', label: '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à', icon: 'ü¶Å', sub: 'Power' },
                    { id: 'health', label: '‡∏≠‡∏≤‡∏¢‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡∏∞', icon: 'üåø', sub: 'Health' }
                ];
            }
            activeCardIndex = 0;
            renderStack();
        }

        function renderStack() {
            const container = document.getElementById('card-stack');
            container.innerHTML = '';
            
            aspectCards.forEach((card, index) => {
                const el = document.createElement('div');
                el.className = `stack-card ${card.id}`;
                
                el.innerHTML = `
                    <div class="stack-card-front">
                        <div class="stack-card-inner-border"></div>
                        <div class="text-6xl mb-4 drop-shadow-md transform transition-transform duration-500">${card.icon}</div>
                        <h3 class="font-bold text-2xl text-white tracking-wider drop-shadow-md">${card.label}</h3>
                        <div class="w-12 h-[1px] bg-white/30 my-3"></div>
                        <p class="text-xs text-white/50 uppercase tracking-[0.3em]">${card.sub}</p>
                    </div>
                    <div class="stack-card-back"></div>
                `;
                
                el.onclick = () => {
                    if(index === activeCardIndex) { nextCard(); }
                    else { activeCardIndex = index; updateStackVisuals(); }
                };
                
                updateCardPosition(el, index);
                container.appendChild(el);
            });
        }

        function updateCardPosition(el, index) {
            el.classList.remove('active', 'next', 'prev', 'hidden-card', 'consecrating');
            let offset = (index - activeCardIndex + aspectCards.length) % aspectCards.length;
            if (offset === 0) el.classList.add('active');
            else if (offset === 1) el.classList.add('next');
            else if (offset === 2) el.classList.add('hidden-card');
            else el.classList.add('prev');
        }

        function updateStackVisuals() {
            document.querySelectorAll('.stack-card').forEach((el, idx) => updateCardPosition(el, idx));
        }
        function nextCard() { activeCardIndex = (activeCardIndex + 1) % aspectCards.length; updateStackVisuals(); }
        function prevCard() { activeCardIndex = (activeCardIndex - 1 + aspectCards.length) % aspectCards.length; updateStackVisuals(); }

        // --- CONSECRATION FLOW ---
        async function generateFromStack() {
            const aspectType = aspectCards[activeCardIndex].id;
            const activeCard = document.querySelector('.stack-card.active');
            
            // 1. Get Image URL
            const imageUrl = getWallpaperImage(selectedDay, aspectType);
            
            // 2. Put Image in Back Face
            const backFace = activeCard.querySelector('.stack-card-back');
            backFace.innerHTML = `<img src="${imageUrl}" class="w-full h-full object-cover rounded-xl" />`;

            // 3. Trigger Animation & Magic
            document.getElementById('magic-overlay').classList.add('active');
            activeCard.classList.add('consecrating');

            // 4. Wait for animation
            setTimeout(() => {
                // Show Toast
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 3000);

                // Show Result View
                const resultImg = document.getElementById('generated-image');
                resultImg.src = imageUrl;
                
                // Add click handler for download
                resultImg.onclick = () => downloadImage(imageUrl);

                document.getElementById('aspect-selection-panel').classList.add('hidden');
                document.getElementById('wallpaper-result').classList.remove('hidden');
                document.getElementById('wallpaper-result').classList.add('flex');
                document.getElementById('magic-overlay').classList.remove('active');
            }, 1600);
        }

        async function downloadImage(dataUrl) {
            try {
                // Fetch the image as a blob to force download
                const response = await fetch(dataUrl);
                const blob = await response.blob();
                const blobUrl = window.URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.download = `meemon-${selectedDay || 'wallpaper'}.jpg`;
                link.href = blobUrl;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(blobUrl);
            } catch (e) {
                // Fallback for simple download
                const link = document.createElement('a');
                link.download = `meemon-${selectedDay || 'wallpaper'}.jpg`;
                link.href = dataUrl;
                link.target = "_blank";
                link.click();
            }
        }

        function getWallpaperImage(day, aspectId) {
            // Retrieve URL from DB
            if (wallpaperDB[day] && wallpaperDB[day][aspectId]) {
                return wallpaperDB[day][aspectId];
            }
            return "https://via.placeholder.com/1080x1920?text=No+Image"; // Fallback
        }

        function resetWallpaperView() {
            selectedDay=''; activeCardIndex=0;
            document.getElementById('day-selection-panel').classList.remove('hidden');
            ['aspect-selection-panel','wallpaper-result'].forEach(id=>{
                const el=document.getElementById(id); el.classList.add('hidden'); el.classList.remove('flex');
            });
        }
        function resetToDaySelection() {
            selectedDay='';
            document.getElementById('day-selection-panel').classList.remove('hidden');
            const el=document.getElementById('aspect-selection-panel'); el.classList.add('hidden'); el.classList.remove('flex');
        }
        function resetToAspectSelection() {
            const res=document.getElementById('wallpaper-result'); res.classList.add('hidden'); res.classList.remove('flex');
            const asp=document.getElementById('aspect-selection-panel'); asp.classList.remove('hidden'); asp.classList.add('flex');
            document.querySelectorAll('.stack-card').forEach(c=>c.classList.remove('consecrating'));
        }
    </script>
</body>
</html>
